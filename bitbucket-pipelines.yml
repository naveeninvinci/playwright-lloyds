image: mcr.microsoft.com/playwright:focal

pipelines:
  default:
    - step:
        name: Run Playwright Tests and Generate Allure Report
        caches:
          - node
        script:
          - apt-get update && apt-get install -y openjdk-11-jre-headless
          - npm install
          - npx playwright install --with-deps
          - HEADLESS=true npx playwright test
          - npx allure generate --single-file allure-results --clean -o static-allure-report
          - ls -l static-allure-report
        artifacts:
          - static-allure-report/*